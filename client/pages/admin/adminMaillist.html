<template name="adminMaillist">

  <div class="row inner-page admin-dashboard">
    <div class="col s12">
      <h4>{{t "Send email to users"}}</h4>
    </div>
    <div class="col s12">
      <h5>{{t "Previous maillist issues"}}</h5>
      <table>
	<thead>
	  <tr>
            <th>{{t "Date"}}</th>
            <th>{{t "Subject"}}</th>
            <th>{{t "Status"}}</th>
            <th>{{t "Reach"}}</th>
            <th>{{t "Action"}}</th>
            <th></th>
            <th></th>
 	  </tr>
	</thead>

                <tbody>
                  {{#each listMaillistMsgs}}
                  <tr {{ifEditing}}>
                    <td>{{formatDate createdAt}}</td>
                    <td>{{subject}}</td>
                    <td><span class="label label-{{label status}}">{{status}}</span></td>
                    <td>{{reach}}/{{numUsersNow}}</td>
                    <td><a href="#" class="btn btn-primary editMsg">{{t "EDIT"}}</a></td>
                    {{#if sent}}
                    <td>
                      <input type="radio" name="{{_id}}" value="all"><small>{{t "ALL"}}</small><br>
                      <input type="radio" name="{{_id}}" value="new"><small>{{t "NEW"}}</small>
                    </td>
                    <td>
                      <button class="btn btn-primary sendMsg" type="button">{{t "RESEND"}}</button>
                    </td>
                    {{else}}
                    {{#if pending}}
                    <td colspan="2">
                      <i class="fa fa-spinner"></i> {{t "Sending"}} {{wentOut}}
                    </td>
                    {{else}}
                    <td colspan="2">
                      <a href="#" class="btn waves-effect waves-light sendMsg">{{t "SEND"}}</a>
                      <a href="#" class="btn waves-effect waves-light red delMsg"><i class="fa fa-trash"></i></a>
                    </td>
                    {{/if}}
                    {{/if}}
                  </tr>
                  {{else}}
                  <tr>
                    <td colspan="5"><h5 class="text-center">{{t "Nothing here yet."}}</h5></td>
                  </tr>
                  {{/each}}
                </tbody>
 
      </table>
    </div>
    
    <div class="col s12">
      {{#if curMsg}}
      <h5>{{t "Edit broadcast message"}}</h5>
      {{else}}
      <h5>{{t "Compose new broadcast message"}}</h5>
      {{/if}}
    </div>

    <div class="col s12">
      {{#autoForm collection="Maillist" id="sendBroadcastMessage" type=fType doc=curMsg}}
      <div>

        {{> afQuickField name="subject"}}
        {{> afQuickField name="message" rows=5 class="materialize-textarea"}}
        {{> afFieldInput type="hidden" name="status" value="PREPARED"}}
<br><br>
        <div class="text-center">
          <button type="submit" class="btn"><i class="mdi-navigation-check left"></i> {{t "Save"}}</button>
          <button type="reset" class="btn-flat red-text"><i class="mdi-navigation-close left"></i> {{t "Reset"}}</button>
          {{#if curMsg}}
          <button class="btn red cancel">{{t "Cancel"}}</button>
          {{/if}}
        </div>
      </div>
      {{/autoForm}}
    </div>

  </div>
</template>
